donnees-hospitalieres-covid19:
  title: Données hospitalières covid19 SPF
  description: Rassemble les données hospitalières covid19 de SPF.
  environment:
    DEBUG: true
  pipeline:
    -
      run: update_package
      parameters:
        name: 'donnees-hospitalieres-covid19'
        title: 'Données hospitalières covid19 SPF'
        homepage: 'https://www.data.gouv.fr/fr/datasets/donnees-hospitalieres-relatives-a-lepidemie-de-covid-19/'
    -
      run: load
      parameters:
        from: "https://www.data.gouv.fr/fr/datasets/r/63352e38-d353-4b54-bfd1-f1b3ee1cabd7"
        name: 'donnees-hospitalieres-covid19'
        format: csv
        # headers: 4
    - run: update_resource
      parameters:
        resources: 'donnees-hospitalieres-covid19'
        metadata:
          schema:
            fields:
              - format: default
                name: dep
                type: string
              - format: default
                name: sexe
                type: integer
              - format: default
                name: jour
                type: date
              - format: default
                name: hosp
                type: integer
              - format: default
                name: rea
                type: integer
              - format: default
                name: rad
                type: integer
              - format: default
                name: dc
                type: integer
            missingValues:
              - ''          
    -
      run: load
      parameters:
        from: "https://www.data.gouv.fr/fr/datasets/r/6fadff46-9efd-4c53-942a-54aca783c30c"
        name: 'donnees-hospitalieres-nouveaux-covid19'
        format: csv
        # headers: 4
    - run: update_resource
      parameters:
        resources: 'donnees-hospitalieres-nouveaux-covid19'
        metadata:
          schema: 
            fields:
            - format: default
              name: dep
              type: string
            - format: default
              name: jour
              type: date
            - format: default
              name: incid_hosp
              type: integer
            - format: default
              name: incid_rea
              type: integer
            - format: default
              name: incid_dc
              type: integer
            - format: default
              name: incid_rad
              type: integer
            missingValues:
            - ''
    -
      run: dump_to_zip
      parameters:
          out-file: donnees-hospitalieres-covid19.zip